<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<!-- basic -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- mobile metas -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<!-- site metas -->
<title>커뮤니티 게시글 수정</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">
<!-- bootstrap css -->
<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
<!-- style css -->
<link rel="stylesheet" type="text/css" href="../css/style.css">
<!-- Responsive-->
<link rel="stylesheet" href="../css/responsive.css">
<!-- fevicon -->
<link rel="icon" href="../images/fevicon.png" type="image/gif" />
<!-- Scrollbar Custom CSS -->
<!-- <link rel="stylesheet" href="../css/jquery.mCustomScrollbar.min.css"> -->
<!-- Tweaks for older IEs-->
<!-- <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"> -->
<!-- owl stylesheets --> 
<!-- <link rel="stylesheet" href="../css/owl.carousel.min.css"> -->
<!-- <link rel="stylesheet" href="../css/owl.theme.default.min.css"> -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen"> -->

<!-- 공식부트스트랩 CSS -->
<link href="../css/bootstrap/bootstrap.css" rel="stylesheet">
<!-- 썸머노트 시작 -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
<!--  썸머노트 끝 -->


      
      
      <style>
        .form-content {
          width: 80%;
          min-height: 700px;
        }
      
      </style>
    </head>
    <body>
      <!-- header section start -->
      <div class="header_section">
        <div class="container-fluid">
          <nav class="navbar navbar-expand-lg navbar-light">
            <div class="main_logo"><a href="/app"><img src="../images/logo.png"></a></div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item"><a class="nav-link" href="../party/list">운동찾기</a></li>
                <li class="nav-item"><a class="nav-link" href="main">커뮤니티</a></li>
                <li class="nav-item"><a class="nav-link" href="../notice/list">공지사항</a></li>
              </ul>
              <div class="login-bt">
                <ul>
                  <li data-th-if="${session.loginMember == null}"><a href="../auth/form" >로그인</a></li>
                  <li data-th-if="${session.loginMember != null}"><a href="../mypage/my-post">마이페이지</a></li>
                  <li data-th-if="${session.loginMember != null}"><a href="../auth/logout" data-th-text="${session.loginMember.name} + '(로그아웃)'">동동(로그아웃)</a></li>
                </ul>
              </div>
            </div>
          </nav>
        </div>
      </div>
      <!-- header section end -->
      
      <!-- furnitures section start -->
      <div class="furnitures_sectionJD layout_padding">
         <a href="main"><h1 class="container" id="community-title">커뮤니티</h1></a>
         <div class="container cate-bottom-line">
           <!-- 게시판 카테고리 이동 시작 -->
           <ul class="nav nav-pills nav-justified">
             <li class="nav-item"><a class="nav-link" href="list?no=1">자유게시판</a></li>
             <li class="nav-item"><a class="nav-link" href="list?no=2">식단게시판</a></li>
             <li class="nav-item"><a class="nav-link" href="list?no=3">챌린지게시판</a></li>
             <li class="nav-item"><a class="nav-link" href="list?no=4">질문게시판</a></li>
             <li class="nav-item"><a class="nav-link" href="list?no=5">핫딜게시판</a></li>
           </ul>
           <!-- 게시판 카테고리 이동 끝 -->
           
           <!-- 게시글 수정폼 시작 -->
           <div class="furnitures_section2 layout_padding">
            <h2>게시글 수정</h2>
            <form action='update' method="post" enctype="multipart/form-data">
                <input id="boardNo" name='no' type="hidden" data-th-value="${board.no}">
                <input name='cateno' type="hidden" data-th-value="${board.cateno}">
                <table>
                    <tr>
                      <td><input name='title' type='text' value='제목' data-th-value='${board.title}' size='60'></td>
                    </tr>
                    <tr data-th-if="${board.cateno == 3}">
                      <td>
                          <div style="width: 300px">
                            <img id="previewImg" th:if="${board.thumbnail != null}"  th:src="@{'/board/files/' + ${board.thumbnail}}" alt="Avatar" class="image party_detail_img">
                            <img id="previewImg" th:if="${board.thumbnail == null}"  src="/app/board/files/nothumpnail.jpg" alt="Avatar" class="image">
                          </div>
                          <input id="fileTag" name='file' type="file">
                      </td>        
                    </tr> 
                    <tr>
                         <td>
                            <textarea name='content' th:text="${board.content}"></textarea>
                        </td> 
                    </tr>
                </table>
                <p>
                    <input id="subBtn" type="button" value="수정" onclick="goWrite(this.form);"/>
                    <input id="subBtn" type="button" value="취소" onclick="updateCancel()"/>
                </p>
            </form>
           </div>
           <!-- 게시글 수정폼 끝 -->
         </div>
     </div>
     <!-- furnitures section end -->
      <!-- copyright section start -->
      <div class="copyright_section">
        <div class="container">
           <div class="social_icon">
              <ul>
                 <li><a href="#"><img src="../images/fb-icon.png"></a></li>
                 <li><a href="#"><img src="../images/twitter-icon.png"></a></li>
                 <li><a href="#"><img src="../images/instagram-icon.png"></a></li>
                 <li><a href="#"><img src="../images/linkedin-icon.png"></a></li>
              </ul>
           </div>
           <p class="copyright_text">2020 All Rights Reserved. Design by <a href="https://html.design">Free html  Templates</a></p>
        </div>
      </div>
      <!-- copyright section end -->

<!-- Javascript files-->
<!-- 썸머노트 자바스크립트 시작 -->
<script>
  function goWrite(frm) {
      var title = frm.title.value;
      var content = frm.content.value;
      if (title.trim() == '') {
        swal('','제목을 입력해주세요','warning');
            return false;
      }
      if (content.trim() == '') {
        swal('','내용을 입력해주세요','warning').then(() =>{
            return false;
        });
      } else {
          swal({
              text : "게시글을 수정하시겠습니까?",
              icon : "info",
              buttons : ["아니요", "예"],
            }).then(function(isConfirm) {
              if (isConfirm) {
                frm.submit();
              } else{
                return false;
              }
          });
      }
  
  }

  $(document).ready(function() {
    $('textarea[name=content]').summernote({maxWidth: 1000, height: 700});
  });

/*   function goWrite(frm) {
    var title = frm.title.value;
    var content = frm.content.value;
    if (title.trim() == '') {
      alert("제목을 입력해주세요");
      return false;
    }
    if (content.trim() == '') {
      alert("내용을 입력해주세요");
      return false;
    }
    frm.submit();
  } */
</script>

<script type="text/javascript">
const boardNo = document.getElementById( 'boardNo').value;
$('#fileTag').on('change', function () {
    if(window.FileReader){
       
    } else {
        var filename = $(this).val().split('/').pop().split('\\').pop();
    }
    $(this).prev().val(filename); //input upload-name 에 파일명 설정해주기

    readImage($(this)[0]); //미리보기
});

function validFileType(filename) {
    const fileTypes = ["png", "jpg", "jpeg"];
return fileTypes.indexOf(filename.substring(filename.lastIndexOf(".")+1, filename.length).toLowerCase()) >= 0;
}

function validFileSize(file){
    if(file.size > 5000000){ //5MB
        return false;
    }else{
        return true;
    }
}

//이미지 띄우기
function readImage(input) {
    if(input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e){
            const previewImage = document.getElementById("previewImg");
            previewImage.src = e.target.result;
        }
        // reader가 이미지 읽도록 하기
        reader.readAsDataURL(input.files[0]);
    }
}
function updateCancel() {
	  swal({
	        text : "게시글을 수정을 취소하시겠습니까?",
	        icon : "info",
	        buttons : ["아니요", "예"],
	      }).then(function(isConfirm) {
	        if (isConfirm) {
	          location.href= 'detail?no=' + boardNo;
	        } else{
	          return false;
	        }
	    });
	}

</script>

<!--    <script src="../js/jquery.min.js"></script> -->
<!-- <script src="../js/popper.min.js"></script> -->
<!-- <script src="../js/bootstrap.bundle.min.js"></script> -->
<script src="../js/jquery-3.0.0.min.js"></script>
<script src="../js/plugin.js"></script>
<!-- sidebar -->
<!-- <script src="../js/jquery.mCustomScrollbar.concat.min.js"></script> -->
<!-- <script src="../js/custom.js"></script>  -->
<!-- javascript --> 
<!-- <script src="../js/owl.carousel.js"></script> -->
<!-- <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>   -->
<!-- sweetalert -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<!-- 공식부트스트랩 JS -->
<!-- <script src="../js/bootstrap/bootstrap.js"></script> -->   
    </body>
</html>